# Восстановление бота: "Разморозка" логики и инвентаря

## Проблема
Бот "завис", инвентарь на сайте не обновляется. Это произошло потому, что в цикле принятия решений (`DecisionEngine`) возникло исключение или блокировка, из-за которой цикл прервался. Также, возможно, ошибка типов в `broadcastStatus` мешает отправке данных.

## Диагностика
В `api/bot/index.ts` метод `broadcastStatus` читает инвентарь. Если `this.bot.inventory` недоступен или его структура изменилась из-за приведения типов, отправка статуса падает, и сайт не получает обновлений.

## Решение

### 1. Безопасное чтение инвентаря
В `api/bot/index.ts` обернуть чтение инвентаря в `try-catch` и добавить проверки на `null`.

### 2. Защита цикла решений
В `api/bot/decision.ts` обернуть весь метод `makeDecision` в `try-catch`. Если произойдет ошибка (например, при поиске пути или крафте), она будет залогирована, но цикл **не остановится** и продолжит работу на следующем тике.

### 3. Исправление "зависания" на крафте
Добавить таймауты (`Promise.race`) к операциям `goto`, `placeBlock`, `craft`. Если действие занимает больше 10 секунд — сбрасывать его и продолжать.

## Шаги реализации
1.  **`api/bot/index.ts`**: Улучшить `broadcastStatus` (добавить `try-catch` и проверки).
2.  **`api/bot/decision.ts`**:
    -   Обернуть `makeDecision` в `try-catch`.
    -   Добавить helper `withTimeout` для асинхронных операций.

Это вернет бота к жизни и заставит его "проглатывать" ошибки, а не умирать от них.
