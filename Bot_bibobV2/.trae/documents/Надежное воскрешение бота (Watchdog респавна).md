# Надежное воскрешение бота и стабилизация

## Проблема
Бот не возрождается после смерти, оставаясь в состоянии "призрака". Текущий обработчик события `death` может не срабатывать, если бот умер *до* запуска скрипта или если пакет не дошел. Ошибки `ECONNREFUSED` — следствие перезапуска сервера.

## Решение

### 1. Усиленная логика респавна
В `api/bot/index.ts`:
-   Добавить периодическую проверку здоровья (Watchdog): Если `bot.health <= 0`, принудительно отправлять пакет респавна каждые 5 секунд, пока бот не оживет.
-   Добавить проверку при входе (`login`): Если бот зашел на сервер мертвым (такое бывает при реконнекте), сразу респавнить.

### 2. Улучшение диагностики
-   Добавить логирование попыток респавна, чтобы видеть в консоли: `Attempting respawn... (Health: 0)`.

## Шаги реализации
1.  **`api/bot/index.ts`**:
    - В методе `setupEvents`:
        - Добавить интервал (например, раз в 5 сек), который проверяет `bot.health`. Если `<= 0`, вызывает функцию `tryRespawn()`.
    - Создать метод `tryRespawn()`, который:
        - Отправляет пакет `client_command` (payload 0).
        - Пытается вызвать `bot.respawn()` (если есть).
        - Пишет лог.

Это гарантирует, что бот не останется лежать мертвым, даже если событие `death` было пропущено.

