# Реализация авто-реконнекта и исправление статуса

## Проблема
1.  **Бот не перезаходит**: При разрыве соединения (`end` или `kicked`) бот просто останавливается и не пытается подключиться снова.
2.  **Зависший интерфейс**: Когда бот офлайн, на сайте продолжают висеть старые данные (здоровье, координаты), вводя пользователя в заблуждение.

## Решение

### 1. Автоматическое переподключение (Auto-Reconnect)
В `api/bot/index.ts`:
-   Добавить флаг `shouldReconnect` (по умолчанию `true`).
-   В обработчиках событий `end` и `kicked`:
    -   Если `shouldReconnect` активно, запускать таймер (через 5 секунд).
    -   Вызывать метод `start()` повторно.
    -   Очищать старый экземпляр бота перед новым подключением.

### 2. Исправление статуса (Dashboard Fix)
-   **Не останавливать** `broadcastInterval` при отключении бота. Пусть он продолжает работать, сообщая статус "Offline".
-   В `broadcastStatus`:
    -   Если `this.bot` равен `null` (или не подключен), отправлять специальный пакет: `connected: false`, `health: 0`, `position: null`.
    -   Это заставит фронтенд понять, что бот отключился, и очистить данные.

### 3. Очистка ресурсов
-   Убедиться, что при переподключении старые слушатели событий и плагины удаляются, чтобы не создавать утечки памяти и дублирование логики.

## Шаги реализации
1.  **`api/bot/index.ts`**:
    -   Модифицировать `stop()`, `start()` и обработчики событий.
    -   Реализовать логику реконнекта.
    -   Обновить `broadcastStatus` для отправки "пустого" состояния.

Это сделает бота полностью автономным: вылетел -> подождал -> зашел снова -> обновил статус.
